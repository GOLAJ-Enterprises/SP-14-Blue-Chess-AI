{% extends "layout.html" %}

{% block head %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/play.css') }}">
<link rel="stylesheet" href="{{ url_for('static', filename='css/chessboard.css') }}">
{% endblock %}

{% block content %}
<div class="play-container">
    <h2>
        {% if mode == "pvp" %}Player vs Player
        {% elif "ai" in mode %}Player vs AI
        {% elif mode == "lan" %}LAN Multiplayer
        {% else %}Unknown Mode{% endif %}
    </h2>

    {% if "ai" in mode %}
        {% if color is none %}
            <div class="color-selection">
                <p>White moves first. Choose your color:</p>
                <div class="color-buttons">
                    <button class="white-btn" onclick="selectColor('w')">White</button>
                    <button class="black-btn" onclick="selectColor('b')">Black</button>
                </div>
            </div>
        {% else %}
            {% include "components/chessboard.html" %}
        {% endif %}
    {% elif mode == "lan" %}
        {% if create %}
            <div class="lan-create-menu">
                <p class="lan-create-menu-subtitle">Create a LAN game</p>
                <p class="lan-create-menu-question">Choose a color to play as:</p>
                <div class="color-buttons lan">
                    <button class="white-btn lan" onclick="createLANGame('w')">White</button>
                    <button class="black-btn lan" onclick="createLANGame('b')">Black</button>
                </div>
            </div>
        
        {% elif game %}
            <!-- You're in a LAN game (host or joined) -->
            <p>Game ID: {{ game }}</p>
            {% include "components/chessboard.html" %}
        {% else %}
            <!-- LAN lobby (before joining) -->
            <div class="lan-menu">
                <div class="lan-buttons">
                    <button id="create-game" onclick="goToCreateLANGame()">Create LAN Game</button>
                    <button id="refresh-games" onclick="refreshLANGames()">Refresh LAN Games</button>
                </div>
                <ul id="lan-game-list"></ul>
            </div>
        {% endif %}
    {% elif mode == "pvp" %}
        {% include "components/chessboard.html" %}
    {% endif %}
</div>
{% endblock %}

{% block scripts %}
<script>
    const GAME_MODE = "{{ mode }}";
    const PLAYER_COLOR = "{{ color }}";
    const GAME_ID = "{{ game }}";
</script>
<script src="{{ url_for('static', filename='scripts/play.js') }}"></script>
<script src="{{ url_for('static', filename='scripts/chessboard.js') }}"></script>
{% endblock %}